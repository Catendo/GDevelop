(self.webpackChunkgdevelop_ide=self.webpackChunkgdevelop_ide||[]).push([[712],{80530:function(e,r,t){var n=t(74149).findGDJS,o=t(50057),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:function(e){var r=e.filterExamples,t=e.onFindGDJS;return(t?t():n()).then((function(e){var t=e.gdjsRoot,n=a.join(t,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(n,"...")),new Promise((function(e,t){i.readdir(n,(function(o,s){if(o)return t(o);var u=s.filter((function(e){return!r||-1===e.indexOf("Example")}));Promise.all(u.map((function(e){return r=a.join(n,e),new Promise((function(e){var t=a.join(r,"JsExtension.js");i.stat(t,(function(r,n){return e(r?null:n.isFile()?t:null)}))}));var r}))).then((function(r){e(r.filter((function(e){return!!e})))}),t)}))}))}))}}},50790:function(e,r,t){var n=t(23570).loadExtension,o=t(50057),a=t(80530).findJsExtensionModules;e.exports=function(e){var r=e.gd,t=e.objectsEditorService,i=e.objectsRenderingService,s=e.filterExamples,u=e.onFindGDJS;return{loadAllExtensions:function(e){return a({filterExamples:s,onFindGDJS:u}).then((function(a){return Promise.all(a.map((function(a){var s=null;try{s=o(a,{rethrowException:!0})}catch(u){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:u}}}return s?(t&&s.registerEditorConfigurations&&s.registerEditorConfigurations(t),i&&(s.registerInstanceRenderers&&s.registerInstanceRenderers(i),s.registerClearCache&&s.registerClearCache(i)),{extensionModulePath:a,result:n(e,r,r.JsPlatform.get(),s)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})))}),(function(e){throw console.error("Unable to find JS extensions modules"),e}))}}}},88947:function(e,r,t){"use strict";t.r(r),t.d(r,{create:function(){return ko}});var n=t(1413),o=t(28381),a=t(29404),i=t(2066),s=t(18375),u=(t(94492),t(13778),t(74165)),c=t(37762),l=t(15861),p=t(93433),f=t(36600),d=t(17037),h=t(33258),v=t(57974),m=t(50057),g=t.n(m),x=t(29439),w=t(79431),b=g()("fs"),y=g()("path");function P(e,r){return j.apply(this,arguments)}function j(){return(j=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i,s,l,p,f,d,h;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return");case 2:n=y.dirname(r.getProjectFile()),o=[],a=(0,c.Z)(t.values()),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=31;break}if(s=i.value,l=s.hasAnyEmbeddedResourceOutsideProjectFolder,p=s.embeddedResources,l){e.next=11;break}return e.abrupt("continue",29);case 11:f=(0,c.Z)(p.values()),e.prev=12,h=(0,u.Z)().mark((function e(){var r,t,a,i,s,c;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=d.value).isOutsideProjectFolder){e.next=3;break}return e.abrupt("return",1);case 3:t=y.basename(r.fullPath),a=y.extname(t),i=y.basename(t,a),s=(0,w.Z)(i,(function(e){var r=y.join(n,e)+a;return b.existsSync(r)})),c=y.join(n,s+a),r.resourceName=s+a,o.push(b.promises.copyFile(r.fullPath,c));case 10:case"end":return e.stop()}}),e)})),f.s();case 15:if((d=f.n()).done){e.next=21;break}return e.delegateYield(h(),"t0",17);case 17:if(!e.t0){e.next=19;break}return e.abrupt("continue",19);case 19:e.next=15;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(12),f.e(e.t1);case 26:return e.prev=26,f.f(),e.finish(26);case 29:e.next=7;break;case 31:e.next=36;break;case 33:e.prev=33,e.t2=e.catch(5),a.e(e.t2);case 36:return e.prev=36,a.f(),e.finish(36);case 39:return e.abrupt("return",Promise.all(o));case 40:case"end":return e.stop()}}),e,null,[[5,33,36,39],[12,23,26,29]])})))).apply(this,arguments)}function k(e,r){var t,n=y.dirname(e.getProjectFile()),o=new Map,a=(0,c.Z)(r);try{for(a.s();!(t=a.n()).done;){var i,s=(0,x.Z)(t.value,2),u=s[0],l=s[1].embeddedResources,p={},f=(0,c.Z)(l.values());try{for(f.s();!(i=f.n()).done;){var h=i.value,v=h.resourceKind,m=h.resourceName,g=h.relPath,w=h.fullPath;m||(m=y.relative(n,w));var b=(0,d.h)(v);if(b){if(b.setName(m),b.setFile(m),p[g]=m,o.has(w)){var P=o.get(w);P&&P.mapping&&(b.setMetadata(JSON.stringify({embeddedResourcesMapping:P.mapping})),o.delete(w))}e.getResourcesManager().addResource(b)}}}catch(j){f.e(j)}finally{f.f()}o.set(u,{mapping:p})}}catch(j){a.e(j)}finally{a.f()}return o}function Z(e,r){return S.apply(this,arguments)}function S(){return(S=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i,s,l,p,f,d,h,m,g,x,w,P,j,k,Z,S;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,b.promises.readFile(t,"utf8");case 4:if(n=e.sent,e.prev=5,!(o=JSON.parse(n))||!o.__header__||"LDtk"!==o.__header__.app){e.next=16;break}a=y.dirname(t),i=new Map,s=!1,l=(0,c.Z)(o.defs.tilesets);try{for(l.s();!(p=l.n()).done;)(f=p.value).relPath&&(d=f.relPath,h=y.resolve(a,d),m=!(0,v.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:m},i.set(d,g),m&&(s=!0))}catch(u){l.e(u)}finally{l.f()}x=(0,c.Z)(o.levels);try{for(x.s();!(w=x.n()).done;)(P=w.value).bgRelPath&&(j=P.bgRelPath,k=y.resolve(a,j),Z=!(0,v.Te)(r,k),S={resourceKind:"image",relPath:j,fullPath:k,isOutsideProjectFolder:Z},i.set(P.bgRelPath,S),Z&&(s=!0))}catch(u){x.e(u)}finally{x.f()}return e.abrupt("return",{hasAnyEmbeddedResourceOutsideProjectFolder:s,embeddedResources:i});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(5),console.error("Unable to read properly the data from file ".concat(t," for use as a tilemap - ignoring any potentially embedded resources.")),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}function F(){return(F=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return n=t.replace(".json",".atlas"),e.next=5,new Promise((function(e){b.promises.access(n,b.constants.F_OK).then((function(){return e(!0)})).catch((function(){return e(!1)}))}));case 5:if(e.sent){e.next=9;break}return console.error("Could not find an atlas file for Spine file ".concat(t,".")),e.abrupt("return",null);case 9:return o=y.basename(n),a=new Map,i=!(0,v.Te)(r,n),s={resourceKind:"atlas",relPath:o,fullPath:n,isOutsideProjectFolder:i},a.set(o,s),e.abrupt("return",{embeddedResources:a,hasAnyEmbeddedResourceOutsideProjectFolder:i});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i,s,l,p,f,d,h,m,g;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return n=null,e.prev=3,e.next=6,b.promises.readFile(t,"utf8");case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Unable to read Spine Atlas file at path ".concat(t,":"),e.t0);case 12:if(n){e.next=14;break}return e.abrupt("return",null);case 14:if(o=/.*\.(png|jpeg|jpg)$/gm,a=n.match(o)){e.next=18;break}return e.abrupt("return",null);case 18:i=y.dirname(t),s=new Map,l=!1,p=(0,c.Z)(a);try{for(p.s();!(f=p.n()).done;)d=f.value,h=y.resolve(i,d),m=!(0,v.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:m},s.set(d,g),m&&(l=!0)}catch(u){p.e(u)}finally{p.f()}return e.abrupt("return",{embeddedResources:s,hasAnyEmbeddedResourceOutsideProjectFolder:l});case 24:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}var D={tilemap:Z,json:Z,spine:function(e,r){return F.apply(this,arguments)},atlas:function(e,r){return E.apply(this,arguments)}},C=t(40243),N=t(32484),O=t(15684),R=t(29343),A=g()("@electron/remote"),T=A?A.dialog:null,L=g()("path"),I=function(e){var r=e.options,t=e.onChooseResources,n=e.createNewResource;return(0,R.jsx)(h.L,{onChoose:function(e){var r=e.url,o=n();o.setFile(r),o.setName(L.basename(r)),o.setOrigin("gdevelop-asset-store",r),t([o])},resourceKind:r.resourceKind})},M=[].concat((0,p.Z)(d.Q.map((function(e){var r=e.kind,t=(e.displayName,e.fileExtensions),n=e.createNewResource,o=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(o){var a,s,p,f,d,h,m,g,x,w,b,y,j,Z,S,F,E,C,N,O,R,I,M;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.i18n,s=o.getLastUsedPath,p=o.setLastUsedPath,f=o.project,d=o.options,h=o.resourcesImporationBehavior,T){e.next=3;break}throw new Error("Electron dialog not supported in this environment.");case 3:return m=["openFile"],d.multiSelection&&m.push("multiSelections"),g=L.dirname(f.getProjectFile()),x=s(f,r)||g,w=A.getCurrentWindow(),e.next=10,T.showOpenDialog(w,{title:a._({id:"Choose a file"}),properties:m,filters:[{name:a._({id:"Supported files"}),extensions:t}],defaultPath:x});case 10:if(b=e.sent,(y=b.filePaths)&&y.length){e.next=14;break}return e.abrupt("return",[]);case 14:if(j=L.parse(y[0]).dir,p(f,r,j),Z=y.some((function(e){return!(0,v.Te)(f,e)})),S=new Map,F=D[r],E=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,c.Z)(r.embeddedResources.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=18;break}if(o=n.value,a=D[o.resourceKind]){e.next=8;break}return e.abrupt("continue",16);case 8:return i=o.fullPath,e.next=11,a(f,i);case 11:if(!(s=e.sent)){e.next=16;break}return S.set(i,s),e.next=16,E(s);case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),t.e(e.t0);case 23:return e.prev=23,t.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[1,20,23,26]])})));return function(r){return e.apply(this,arguments)}}(),!F){e.next=44;break}C=(0,c.Z)(y),e.prev=22,C.s();case 24:if((N=C.n()).done){e.next=36;break}return O=N.value,e.next=28,F(f,O);case 28:if(!(R=e.sent)){e.next=34;break}return e.next=32,E(R);case 32:S.set(O,R),R.hasAnyEmbeddedResourceOutsideProjectFolder&&(Z=!0);case 34:e.next=24;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(22),C.e(e.t0);case 41:return e.prev=41,C.f(),e.finish(41);case 44:if(I=new Map,M=new Map,!Z){e.next=54;break}if(!("relative"!==h&&("import"===h||i.ZP.showConfirmDialog(a._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"}))))){e.next=54;break}return e.next=51,(0,v.ZC)(f,y,I);case 51:return y=e.sent,e.next=54,P(f,S);case 54:return M=k(f,S),e.abrupt("return",y.map((function(e){var r=n();r.setFile(L.relative(g,e)),r.setName(L.relative(g,e));var t=I.has(e)?I.get(e):e;if(t){var o=M.get(t);o&&o.mapping&&r.setMetadata(JSON.stringify({embeddedResourcesMapping:o.mapping}))}return r})));case 56:case"end":return e.stop()}}),e,null,[[22,38,41,44]])})));return function(r){return e.apply(this,arguments)}}();return{name:"local-file-opener-"+r,displayName:{id:"Choose a file"},displayTab:"import",onlyForStorageProvider:"LocalFile",kind:r,selectResourcesHeadless:o,renderComponent:function(e){return(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(N.Z,{primary:!0,label:e.options.multiSelection?(0,R.jsx)(f.Trans,{id:"Choose one or more files"}):(0,R.jsx)(f.Trans,{id:"Choose a file"}),onClick:(0,l.Z)((0,u.Z)().mark((function r(){var t;return(0,u.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o({i18n:e.i18n,project:e.project,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,getLastUsedPath:e.getLastUsedPath,setLastUsedPath:e.setLastUsedPath,options:e.options,resourcesImporationBehavior:e.resourcesImporationBehavior});case 2:t=r.sent,e.onChooseResources(t);case 4:case"end":return r.stop()}}),r)})))})})}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"upload-".concat(r),displayName:{id:"File(s) from your device"},displayTab:"import",onlyForStorageProvider:"Cloud",kind:r,renderComponent:function(e){return(0,R.jsx)(O.V,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,automaticallyOpenInput:!!e.automaticallyOpenIfPossible},"url-chooser-".concat(r))}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"resource-store-".concat(r),displayName:{id:"Choose from asset store"},displayTab:"standalone",kind:r,renderComponent:function(e){return(0,R.jsx)(I,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options},"resource-store-".concat(r))}}})))),U=M,_=t(4942),J=t(32705),W=t(62800),B=t(81303),G=g()("path"),H=g()("fs"),z=g()("electron"),K=z?z.ipcRenderer:null,X=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K){e.next=2;break}throw new Error("Not supported.");case 2:return e.next=4,K.invoke("".concat(r,"-load"),t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),V=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s,c,p;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.resourceNames,o=G.dirname(t.getProjectFile()),a=[],i=[],s=t.getResourcesManager(),n.forEach((function(e){if(s.hasResource(e)){var r=s.getResource(e).getFile();(0,v.PX)(r)?(0,v.Gu)(r)?console.error("Unsupported blob URL for a resource - ignoring it."):a.push({url:r,resourceName:e}):i.push({localFilePath:r,resourceName:e})}})),e.next=8,(0,B.R7)({urlContainers:a,onProgress:function(e,r){}});case 8:return c=e.sent,p=new Map,e.next=12,Promise.all(c.map(function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.error,t=r.blob,n=r.item,!t){e.next=15;break}return e.prev=2,e.t0=p,e.t1=n.resourceName,e.next=7,(0,B.oT)(t);case 7:e.t2=e.sent,e.t3={dataUrl:e.t2},e.t0.set.call(e.t0,e.t1,e.t3),e.next=15;break;case 12:e.prev=12,e.t4=e.catch(2),console.error('Unable to read data from resource "'.concat(n.resourceName,'" - ignoring it.'),e.t4);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(r){return e.apply(this,arguments)}}()));case 12:return e.next=14,Promise.all(i.map(function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.localFilePath,n=r.resourceName,e.prev=1,e.next=4,H.promises.readFile(G.resolve(o,t));case 4:a=e.sent,p.set(n,{localFilePath:t,dataUrl:"data:text/plain;base64,"+a.toString("base64")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error('Unable to read local file "'.concat(t,'" - ignoring it.'),e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}()));case 14:return e.abrupt("return",n.map((function(e){var r=p.get(e);if(!r)return{name:e,dataUrl:""};var t=r.localFilePath;return{name:e,dataUrl:r.dataUrl,localFilePath:t}})));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s,c,l,p,f,d,h;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.externalEditorName,n=r.defaultName,o=r.metadataKey,a=r.resourceKind,i=r.options,s=i.project,c=i.resourceNames,l=i.resourceManagementProps,e.next=4,V({project:s,resourceNames:c});case 4:return p=e.sent,f={singleFrame:i.extraOptions.singleFrame,externalEditorData:(0,J.Z2)(o,i.extraOptions.existingMetadata),fps:i.extraOptions.fps,isLooping:i.extraOptions.isLooping,name:i.extraOptions.name||c[0]||n,resources:p},(0,W.sY)(t),e.next=9,X(t,f);case 9:if(d=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,(0,J.Zv)({baseNameForNewResources:d.baseNameForNewResources,project:s,resources:d.resources,resourceKind:a});case 14:return h=e.sent,e.prev=15,e.next=18,l.onFetchNewlyAddedResources();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(15),console.error("An error happened while fetching the newly added resources:",e.t0);case 23:return(0,J.$N)({modifiedResources:h,metadataKey:o,metadata:i.extraOptions.singleFrame?d.externalEditorData:null}),(0,J.TD)(h.map((function(e){return e.resource.getName()})),d.externalEditorData),e.abrupt("return",{resources:h.map((function(e){var r=e.resource,t=e.originalIndex;return{name:r.getName(),originalIndex:t}})),newName:d.baseNameForNewResources,newMetadata:(0,_.Z)({},o,d.externalEditorData)});case 26:case"end":return e.stop()}}),e,null,[[15,20]])})));return function(r){return e.apply(this,arguments)}}(),Q=[{name:"piskel-app",createDisplayName:{id:"Create with Piskel"},editDisplayName:{id:"Edit with Piskel"},kind:"image",edit:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"piskel",defaultName:"New image",metadataKey:"pskl",resourceKind:"image"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Jfxr",createDisplayName:{id:"Create with Jfxr"},editDisplayName:{id:"Edit with Jfxr"},kind:"audio",edit:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"jfxr",defaultName:"New sound effect",metadataKey:"jfxr",resourceKind:"audio"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Yarn",createDisplayName:{id:"Create with Yarn"},editDisplayName:{id:"Edit with Yarn"},kind:"json",edit:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"yarn",defaultName:"New dialogue tree",metadataKey:"yarn",resourceKind:"json"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}],$=Q,q=t(15671),ee=t(43144),re=t(60136),te=t(29388),ne=g()("os"),oe=function(){try{return ne.userInfo().uid}catch(e){return""}},ae=g()("fs-extra"),ie=g()("path"),se=g()("os"),ue=t.g.gd,ce=ie.posix||ie,le=(0,ee.Z)((function e(r){var t=this;(0,q.Z)(this,e),this._filesToDownload={},this.getAllUrlFilesIn=function(e){var r=ce.normalize(e).replace(/\\/g,"/");return Object.keys(t._filesToDownload).filter((function(e){return 0===e.indexOf(r)})).map((function(e){return{filePath:e,url:t._filesToDownload[e]}}))},this.mkDir=function(e){if(!(0,v.PX)(e)){try{ae.mkdirsSync(e)}catch(r){return console.error("mkDir("+e+") failed: "+r),!1}return!0}},this.dirExists=function(e){return!!(0,v.PX)(e)||ae.existsSync(e)},this.clearDir=function(e){try{ae.emptyDirSync(e)}catch(r){console.error("clearDir("+e+") failed: "+r)}},this.getTempDir=function(){return ie.join(se.tmpdir(),"GDTMP-".concat(oe()))},this.fileNameFrom=function(e){return!t._downloadUrlsToLocalFiles&&(0,v.PX)(e)?e:ie.basename(e)},this.dirNameFrom=function(e){return ie.dirname(e).replace(/\\/g,"/")},this.makeAbsolute=function(e,r){return(0,v.PX)(e)?e:(t.isAbsolute(r)||(r=ie.resolve(r)),ie.resolve(r,ie.normalize(e)).replace(/\\/g,"/"))},this.makeRelative=function(e,r){return(0,v.PX)(e)?e:ie.relative(r,ie.normalize(e)).replace(/\\/g,"/")},this.isAbsolute=function(e){return!!(0,v.PX)(e)||(0===e.length||(e.length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},this.copyFile=function(e,r){if((0,v.PX)(e))return!t._downloadUrlsToLocalFiles||((0,v.PX)(r)?(console.error("Destination can't be a URL in copyFile (from ".concat(e," to ").concat(r,").")),!1):(t._filesToDownload[ce.normalize(r)]=e,!0));try{e!==r&&ae.copySync(e,r)}catch(n){return console.error("copyFile("+e+", "+r+") failed: "+n),!1}return!0},this.writeToFile=function(e,r){try{ae.outputFileSync(e,r)}catch(t){return console.error("writeToFile("+e+", ...) failed: "+t),!1}return!0},this.readFile=function(e){try{return ae.readFileSync(e).toString()}catch(r){return console.error("readFile("+e+") failed: "+r),""}},this.readDir=function(e,r){r=r.toUpperCase();var t=new ue.VectorString;try{ae.existsSync(e)&&ae.readdirSync(e).forEach((function(n){0!==r.length&&-1===n.toUpperCase().indexOf(r,n.length-r.length)||t.push_back(e+"/"+n)}))}catch(n){console.error("readDir("+e+","+r+") failed: "+n)}return t},this.fileExists=function(e){var r=ce.normalize(e);if(!!t._filesToDownload[r])return!0;try{return ae.statSync(e).isFile()}catch(n){return!1}},this._downloadUrlsToLocalFiles=!!r&&r.downloadUrlsToLocalFiles})),pe=le,fe=t(74149),de=t(1773),he=t(67835),ve=t(86278),me=t(78081),ge=t(75087),xe=t(94553),we=t(6996),be=function(e){var r=e.url,t=e.open,n=e.error,o=e.onExport,a=e.onClose,i=e.onRunPreviewLocally,s=(0,we.U)().isMobile;if(!t)return null;var u=r?"http://".concat(r):"";return(0,R.jsxs)(de.ZP,{title:(0,R.jsx)(f.Trans,{id:"Preview"}),actions:[(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Close"}),primary:!0,onClick:a},"close")],secondaryActions:[o&&(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Export game"}),onClick:o},"export"),(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Run on this computer"}),onClick:i},"run-preview-locally")],open:t,onRequestClose:a,maxWidth:"sm",children:[n&&(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."})})}),!n&&!r&&(0,R.jsx)(me.Z,{}),!n&&r&&(0,R.jsxs)("div",{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"})})}),(0,R.jsx)(ge.Z,{url:r}),u&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Or flash this QR code:"})})}),(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(xe.Z,{url:u,size:s?100:150})})]}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Please note that your device should be connected on the same network as this computer."})})})]})]})},ye=t(25842),Pe=t.n(ye),je=t(79987),ke=g()("electron"),Ze=ke?ke.ipcRenderer:null,Se="stopped",Fe=null,Ee=[],De=[],Ce={startServer:function(){if(!Ze)return Promise.reject();if("started"===Se)return Promise.resolve();var e=new Promise((function(e,r){var t=!1;Se="stopped",Fe=null,Ze&&(Ze.removeAllListeners("debugger-send-message-done"),Ze.removeAllListeners("debugger-error-received"),Ze.removeAllListeners("debugger-connection-closed"),Ze.removeAllListeners("debugger-connection-opened"),Ze.removeAllListeners("debugger-connection-errored"),Ze.removeAllListeners("debugger-start-server-done"),Ze.removeAllListeners("debugger-message-received")),Ze.on("debugger-error-received",(function(e,n){t||(r(n),t=!0),Ee.forEach((function(e){return(0,e.onErrorReceived)(n)}))})),Ze.on("debugger-connection-closed",(function(e,r){var t=r.id,n=De.indexOf(t);-1!==n&&De.splice(n,1),Ee.forEach((function(e){return(0,e.onConnectionClosed)({id:t,debuggerIds:De})}))})),Ze.on("debugger-connection-opened",(function(e,r){var t=r.id;De.push(t),Ee.forEach((function(e){return(0,e.onConnectionOpened)({id:t,debuggerIds:De})}))})),Ze.on("debugger-connection-errored",(function(e,r){var t=r.id,n=r.errorMessage;Ee.forEach((function(e){return(0,e.onConnectionErrored)({id:t,errorMessage:n})}))})),Ze.on("debugger-start-server-done",(function(r,n){var o=n.address;console.info("Local preview debugger started"),Se="started",Fe=o,t||(e(),t=!0),Ee.forEach((function(e){return(0,e.onServerStateChanged)()}))})),Ze.on("debugger-message-received",(function(e,r){var t=r.id,n=r.message;console.info("Processing message received for debugger");try{var o=JSON.parse(n);Ee.forEach((function(e){return(0,e.onHandleParsedMessage)({id:t,parsedMessage:o})}))}catch(a){console.warn("Error while parsing message received from debugger client:",a)}})),Ze.send("debugger-start-server")})),r=new Promise((function(e,r){setTimeout((function(){r(new Error("Debugger server not started or errored after 5s - aborting."))}),5e3)}));return Promise.race([e,r])},sendMessage:function(e,r){Ze&&("stopped"!==Se?Ze.send("debugger-send-message",{id:e,message:JSON.stringify(r)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:function(){return Se},getExistingDebuggerIds:function(){return De},registerCallbacks:function(e){return Ee.push(e),function(){var r=Ee.indexOf(e);-1!==r&&Ee.splice(r,1)}}},Ne=g()("electron"),Oe=g()("path"),Re=Ne?Ne.ipcRenderer:null,Ae=t.g.gd,Te=function(e){(0,re.Z)(t,e);var r=(0,te.Z)(t);function t(){var e;(0,q.Z)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=r.call.apply(r,[this].concat(o))).canDoNetworkPreview=function(){return!0},e.canDoHotReload=function(){return!0},e.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,previewBrowserWindowOptions:null,hotReloadsCount:0,hideMenuBar:!0,alwaysOnTop:!0},e._networkPreviewSubscriptionChecker=null,e._hotReloadSubscriptionChecker=null,e._openPreviewBrowserWindow=function(){var r=e.state,t=r.previewGamePath,n=r.previewBrowserWindowOptions;n&&t&&Re&&Re.invoke("preview-open",{previewBrowserWindowOptions:n,previewGameIndexHtmlPath:"file://".concat(t,"/index.html"),alwaysOnTop:e.state.alwaysOnTop,hideMenuBar:e.state.hideMenuBar})},e.closePreview=function(e){Re&&Re.invoke("preview-close",{windowId:e})},e._openPreviewWindow=function(r,t,n){e.setState({previewBrowserWindowOptions:{width:r.getGameResolutionWidth(),height:r.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(r.getName()),backgroundColor:"#000000",webPreferences:{webSecurity:!1,nodeIntegration:!0,contextIsolation:!1}},previewGamePath:t,hideMenuBar:!n.getIsMenuBarHiddenInPreview(),alwaysOnTop:n.getIsAlwaysOnTopInPreview()},(function(){if(n.networkPreview){if(!Re)return;Re.removeAllListeners("serve-folder-done"),Re.removeAllListeners("local-network-ips"),Re.on("serve-folder-done",(function(r,t,n){t?e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:t}):e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:n.port}),setTimeout((function(){return e._checkSubscriptionForNetworkPreview()}))})),Re.on("local-network-ip",(function(r,t){e.setState({networkPreviewHost:t})})),Re.send("serve-folder",{root:t}),Re.send("get-local-network-ip")}else e._openPreviewBrowserWindow()}))},e._prepareExporter=function(){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!1}),n=Pe()(new Ae.AbstractFileSystemJS,t);return{outputDir:Oe.join(n.getTempDir(),"preview"),exporter:new Ae.Exporter(n,r),gdjsRoot:r}}))},e.launchPreview=function(r){var t=r.project,n=r.layout,o=r.externalLayout;return e.getPreviewDebuggerServer().startServer().catch((function(e){console.error("Unable to start the Debugger Server for the preview:",e)})).then((function(){return e._prepareExporter()})).then((function(a){var s=a.outputDir,u=a.exporter,c=a.gdjsRoot;!function(e,r){var t=performance.now();e(),r(performance.now()-t)}((function(){var a=new Ae.PreviewExportOptions(t,s);a.setIsDevelopmentEnvironment(i.ZP.isDev()),a.setLayoutName(n.getName()),o&&a.setExternalLayoutName(o.getName());var l=Fe;l&&a.useWebsocketDebuggerClientWithServerAddress(l.address,""+l.port);var p=e.props.getIncludeFileHashs();for(var f in p){var d=p[f];a.setIncludeFileHash(f,d)}a.setElectronRemoteRequirePath(Oe.join(c,"../preview_node_modules","@electron/remote","renderer/index.js"));var h=e.getPreviewDebuggerServer().getExistingDebuggerIds(),v=r.hotReload&&!!h.length;a.setProjectDataOnlyExport(v&&r.projectDataOnlyExport),a.setFullLoadingScreen(r.fullLoadingScreen),r.fallbackAuthor&&a.setFallbackAuthor(r.fallbackAuthor.id,r.fallbackAuthor.username),u.exportProjectForPixiPreview(a),a.delete(),u.delete(),v?(h.forEach((function(r){e.getPreviewDebuggerServer().sendMessage(r,{command:"hotReload"})})),e.state.hotReloadsCount%16===0&&e._hotReloadSubscriptionChecker&&e._hotReloadSubscriptionChecker.checkUserHasSubscription(),e.setState((function(e){return{hotReloadsCount:e.hotReloadsCount+1}}))):e._openPreviewWindow(t,s,r)}),(function(e){return console.info("Preview took ".concat(e,"ms"))}))}))},e._checkSubscriptionForNetworkPreview=function(){return!e._networkPreviewSubscriptionChecker||e._networkPreviewSubscriptionChecker.checkUserHasSubscription()},e}return(0,ee.Z)(t,[{key:"getPreviewDebuggerServer",value:function(){return Ce}},{key:"render",value:function(){var e=this,r=this.state,t=r.networkPreviewDialogOpen,n=r.networkPreviewHost,a=r.networkPreviewPort,i=r.networkPreviewError;return(0,R.jsxs)(o.Fragment,{children:[(0,R.jsx)(je.Z,{ref:function(r){return e._networkPreviewSubscriptionChecker=r},onChangeSubscription:function(){return e.setState({networkPreviewDialogOpen:!1})},id:"Preview over wifi",title:(0,R.jsx)(f.Trans,{id:"Preview over wifi"}),mode:"try"}),(0,R.jsx)(je.Z,{ref:function(r){return e._hotReloadSubscriptionChecker=r},id:"Hot reloading",title:(0,R.jsx)(f.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),(0,R.jsx)(be,{open:t,url:n&&a?"".concat(n,":").concat(a):null,error:i,onClose:function(){return e.setState({networkPreviewDialogOpen:!1})},onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow})]})}}]),t}(o.Component),Le=t(73818),Ie=t(76349),Me=t(19431),Ue=g()("electron"),_e=Ue?Ue.shell:null,Je=t.g.gd,We="local-cordova",Be={name:We,packageNameWarningType:"mobile",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(Ie.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Le.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Ie.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:We}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Je.AbstractFileSystemJS,t);return{exporter:new Je.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Je.ExportOptions(r.project,r.exportState.outputDir)).setTarget("cordova"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=function(){_e&&_e.openPath(r.outputDir)};return(0,R.jsx)(Ie.Eg,{renderGameButton:function(){return(0,R.jsx)(N.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Ge=t(41426),He=g()("electron"),ze=He?He.shell:null,Ke=t.g.gd,Xe="local-electron",Ve={name:Xe,packageNameWarningType:"desktop",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(Ge.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Le.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Ge.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Xe}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Ke.AbstractFileSystemJS,t);return{exporter:new Ke.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Ke.ExportOptions(r.project,r.exportState.outputDir)).setTarget("electron"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=function(){ze&&ze.openPath(r.outputDir)};return(0,R.jsx)(Ge.Eg,{renderGameButton:function(){return(0,R.jsx)(N.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Ye=t(39935),Qe=t(95644),$e=g()("electron"),qe=$e?$e.shell:null,er=t.g.gd,rr="local-html5",tr={name:rr,getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderTutorial:function(){return(0,R.jsx)(Qe.Z,{tutorialId:"export-to-itch"})},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(Ye.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Le.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Ye.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:rr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new er.AbstractFileSystemJS,t);return{exporter:new er.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=new er.ExportOptions(r.project,r.exportState.outputDir),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState;return(0,R.jsx)(Ye.Eg,{renderGameButton:function(){return(0,R.jsx)(N.Z,{primary:!0,onClick:function(){qe&&qe.openPath(r.outputDir)},label:(0,R.jsx)(f.Trans,{id:"Open the exported game folder"})})}})}},nr=t(29277),or=g()("electron"),ar=g()("@electron/remote"),ir=ar?ar.dialog:null,sr={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}},ur=function(e){var r=e.value,t=e.onChange,o=e.title,a=e.message,i=e.defaultPath,s=e.fullWidth,c=e.filters,p=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(){var r,n,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ir&&or){e.next=2;break}return e.abrupt("return");case 2:return r=ar.getCurrentWindow(),e.next=5,ir.showSaveDialog(r,{title:o,filters:c,message:a,defaultPath:i});case 5:n=e.sent,s=n.filePath,t(s||"");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,R.jsxs)("div",{style:(0,n.Z)((0,n.Z)({},sr.container),{},{width:s?"100%":void 0}),children:[(0,R.jsx)(nr.ZP,{margin:"dense",style:sr.textField,type:"text",translatableHintText:{id:"Choose a file"},value:r,onChange:function(e,r){return t(r)}}),(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Choose"}),style:sr.button,onClick:p})]})};function cr(e){var r=!1,t=void 0;return function(){return r||(console.info("Lazy loading ".concat(e,"...")),t=g()(e),r=!0),t}}var lr=g()("fs"),pr=cr("archiver"),fr=function(e){var r=e.path,t=e.outputFilename,n=e.sizeLimit,o=pr();return new Promise((function(e,a){if(!lr||!o)return a(new Error("Archiver unavailable"));var i=lr.createWriteStream(t),s=o("zip",{zlib:{level:9}});i.on("close",(function(){var r=s.pointer();if(console.log("Archive written at ".concat(t,", ").concat(r," total bytes.")),n&&r>n){var o=Math.round(r/1e6);a(new Error("Archive is of size ".concat(o," MB, which is above the limit allowed of ").concat(n/1e6," MB.")))}e(t)})),s.on("error",(function(e){a(e)})),s.pipe(i),s.directory(r,!1),s.finalize()}))},dr=t(15745),hr=g()("path"),vr=g()("electron"),mr=g()("@electron/remote"),gr=mr?mr.app:null,xr=vr?vr.shell:null,wr=t.g.gd,br="local-facebook-instant-games",yr={name:br,getInitialExportState:function(e){return{archiveOutputFilename:gr?hr.join(gr.getPath("documents"),"fb-instant-game.zip"):""}},canLaunchBuild:function(e){return!!e.archiveOutputFilename},isNavigationDisabled:function(){return!1},renderHeader:function(e){e.project;var r=e.exportState,t=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(dr.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(ur,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:r.archiveOutputFilename,defaultPath:gr?gr.getPath("documents"):"",onChange:function(e){return t((function(){return{archiveOutputFilename:e}}))},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(dr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:br}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new wr.AbstractFileSystemJS,t),o=new wr.Exporter(n,r),a=hr.join(n.getTempDir(),"FacebookInstantGamesExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(s=new wr.ExportOptions(r.project,i)).setTarget("facebookInstantGames"),n&&s.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(s),s.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir;return fr({path:t,outputFilename:e.exportState.archiveOutputFilename})},renderDoneFooter:function(e){var r=e.exportState,t=function(){xr&&hr&&xr.openPath(hr.dirname(r.archiveOutputFilename))};return(0,R.jsx)(dr.Eg,{renderGameButton:function(){return(0,R.jsx)(N.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Pr=t(10959),jr=g()("electron"),kr=jr?jr.ipcRenderer:null,Zr=function(e,r,t){return kr?(kr.removeAllListeners("local-file-upload-progress"),kr.removeAllListeners("local-file-upload-done"),new Promise((function(n,o){kr.on("local-file-upload-progress",(function(e,r,n){t(r,n)})),kr.on("local-file-upload-done",(function(e,r){if(r)return o(r);n()})),kr.send("local-file-upload",e,r)}))):Promise.reject("No support for local file upload")},Sr=t(61421),Fr=g()("path"),Er=g()("os"),Dr=t.g.gd,Cr="local-online-cordova",Nr={name:Cr,onlineBuildType:"cordova-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["androidApk"],keystore:"new",signingDialogOpen:!1}},canLaunchBuild:function(e,r,t){return r||""===t},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Sr.s_,(0,n.Z)({},e))},shouldSuggestBumpingVersionNumber:function(){return!0},renderExportFlow:function(e){return(0,R.jsx)(Sr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Cr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Dr.AbstractFileSystemJS,t),o=new Dr.Exporter(n,r),a=Fr.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(s=new Dr.ExportOptions(r.project,i)).setTarget("cordova"),n&&s.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(s),s.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Er.tmpdir();return fr({path:t,outputFilename:Fr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,s=r.firebaseUser;return s?(0,Pr.$C)(i,s.uid,t,e.targets,e.keystore,n,o,a):Promise.reject(new Error("User is not authenticated"))}},Or=t(82828),Rr=g()("path"),Ar=g()("os"),Tr=t.g.gd,Lr="local-online-cordova-ios",Ir={name:Lr,onlineBuildType:"cordova-ios-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["iosAppStore"],signing:null}},canLaunchBuild:function(e,r,t){return(r||""===t)&&!!e.signing},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Or.s_,(0,n.Z)({},e))},shouldSuggestBumpingVersionNumber:function(){return!0},renderExportFlow:function(e){return(0,R.jsx)(Or.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Lr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Tr.AbstractFileSystemJS,t),o=new Tr.Exporter(n,r),a=Rr.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(s=new Tr.ExportOptions(r.project,i)).setTarget("cordova"),n&&s.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(s),s.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Ar.tmpdir();return fr({path:t,outputFilename:Rr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,s=r.profile;return s?e.signing?(0,Pr.NZ)(i,s.id,t,e.targets,e.signing,n,o,a):Promise.reject(new Error("Signing options not set up")):Promise.reject(new Error("User is not authenticated"))}},Mr=t(87335),Ur=g()("path"),_r=g()("os"),Jr=t.g.gd,Wr="local-online-electron",Br={name:Wr,onlineBuildType:"electron-build",limitedBuilds:!0,packageNameWarningType:"desktop",getInitialExportState:function(){return{targets:["winExe"]}},canLaunchBuild:function(e,r,t){return!!e.targets.length&&(r||""===t)},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Mr.s_,(0,n.Z)({},e))},renderExportFlow:function(e){return(0,R.jsx)(Mr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Wr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Jr.AbstractFileSystemJS,t),o=new Jr.Exporter(n,r),a=Ur.join(n.getTempDir(),"OnlineElectronExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(s=new Jr.ExportOptions(r.project,i)).setTarget("electron"),n&&s.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(s),s.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=_r.tmpdir();return fr({path:t,outputFilename:Ur.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,s=r.firebaseUser;return s?(0,Pr.ch)(i,s.uid,t,e.targets,n,o,a):Promise.reject(new Error("User is not authenticated"))}},Gr=t(96516),Hr=t(4615),zr=g()("path"),Kr=g()("os"),Xr=t.g.gd,Vr="local-online-web",Yr={name:Vr,onlineBuildType:"web-build",getInitialExportState:function(){return null},canLaunchBuild:function(e,r,t){return r||""===t||"done"===t},isNavigationDisabled:function(e,r){return!r&&!["","done"].includes(e)},renderHeader:function(){return(0,R.jsx)(Gr.if,{})},renderExportFlow:function(e){return(0,R.jsx)(Hr.Z,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Vr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Xr.AbstractFileSystemJS,t),o=new Xr.Exporter(n,r),a=zr.join(n.getTempDir(),"OnlineWebExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i,s;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,s=new Xr.ExportOptions(r.project,i),n&&s.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(s),s.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Kr.tmpdir();return fr({path:t,outputFilename:zr.join(n,"game-archive.zip"),sizeLimit:25e7})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,s=r.firebaseUser;return s?(0,Pr.Bc)(i,s.uid,t,n,o,a):Promise.reject(new Error("User is not authenticated"))}},Qr=(0,n.Z)((0,n.Z)({},Gr.O1),{},{exportPipeline:Yr}),$r=[(0,n.Z)((0,n.Z)({},Ye.BN),{},{exportPipeline:tr}),(0,n.Z)((0,n.Z)({},Sr.Vf),{},{exportPipeline:Nr}),(0,n.Z)((0,n.Z)({},Or.Y$),{},{exportPipeline:Ir}),(0,n.Z)((0,n.Z)({},Mr.OL),{},{exportPipeline:Br}),(0,n.Z)((0,n.Z)({},dr.xu),{},{exportPipeline:yr})],qr=[(0,n.Z)((0,n.Z)({},Ye.BN),{},{exportPipeline:tr}),(0,n.Z)((0,n.Z)({},Ie.VU),{},{exportPipeline:Be}),(0,n.Z)((0,n.Z)({},Ge.c8),{},{exportPipeline:Ve})],et=t(76288),rt=t(36559),tt=t(36262),nt=g()("electron"),ot=g()("@electron/remote"),at=ot?ot.app:null,it=nt?nt.ipcRenderer:null,st=function(e){var r=e.ipcEvent,t=e.callback,n=e.shouldApply;o.useEffect((function(){if(it&&n){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return it.on(r,e),function(){return it.removeListener(r,e)}}}),[r,t,n])},ut=function(e){var r=e.event,t=e.callback;o.useEffect((function(){if(at){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return at.on(r,e),function(){return at.removeListener(r,e)}}}),[r,t])},ct=function(e){if(!e)return!1;var r=e.toLowerCase();return r.startsWith("gdevelop")&&"gdevelop dialogue tree editor (yarn)"!==r&&"gdevelop sound effects editor (jfxr)"!==r&&"gdevelop image editor (piskel)"!==r},lt=function(e){var r=e.props,t=e.callbacks,n=e.extraCallbacks,a=r.i18n,i=r.project,s=r.canSaveProjectAs,u=r.recentProjectFiles,c=r.shortcutMap,l=r.isApplicationTopLevelMenu,p=n.onClosePreview,f=a.language,d=o.useState(!0),h=(0,x.Z)(d,2),v=h[0],m=h[1],g=o.useState(ot.getCurrentWindow().id),w=(0,x.Z)(g,2),b=w[0],y=w[1],P=!v&&p?function(){return p(b)}:null,j=o.useContext(tt.ZP).values.useShortcutToClosePreviewWindow;ut({event:"browser-window-focus",callback:function(e){y(e.id),m(ct(e.title))}}),ut({event:"browser-window-blur",callback:function(e){m(!ct(e.title))}}),st({ipcEvent:"main-menu-open",callback:t.onChooseProject,shouldApply:v}),st({ipcEvent:"main-menu-open-recent",callback:t.onOpenRecentFile,shouldApply:v}),st({ipcEvent:"main-menu-save",callback:t.onSaveProject,shouldApply:v}),st({ipcEvent:"main-menu-save-as",callback:t.onSaveProjectAs,shouldApply:v}),st({ipcEvent:"main-menu-show-version-history",callback:t.onShowVersionHistory,shouldApply:v}),st({ipcEvent:"main-menu-close",callback:j&&P?P:t.onCloseProject,shouldApply:!(!j||!P)||v}),st({ipcEvent:"main-menu-close-app",callback:t.onCloseApp,shouldApply:v}),st({ipcEvent:"main-menu-export",callback:t.onExportProject,shouldApply:v}),st({ipcEvent:"main-menu-invite-collaborators",callback:t.onInviteCollaborators,shouldApply:v}),st({ipcEvent:"main-menu-create-template",callback:t.onCreateProject,shouldApply:v}),st({ipcEvent:"main-menu-create-blank",callback:t.onCreateBlank,shouldApply:v}),st({ipcEvent:"main-menu-open-project-manager",callback:t.onOpenProjectManager,shouldApply:v}),st({ipcEvent:"main-menu-open-home-page",callback:t.onOpenHomePage,shouldApply:v}),st({ipcEvent:"main-menu-open-debugger",callback:t.onOpenDebugger,shouldApply:v}),st({ipcEvent:"main-menu-open-about",callback:t.onOpenAbout,shouldApply:v}),st({ipcEvent:"main-menu-open-preferences",callback:t.onOpenPreferences,shouldApply:v}),st({ipcEvent:"main-menu-open-language",callback:t.onOpenLanguage,shouldApply:v}),st({ipcEvent:"main-menu-open-profile",callback:t.onOpenProfile,shouldApply:v}),st({ipcEvent:"update-status",callback:t.setElectronUpdateStatus,shouldApply:!0}),o.useEffect((function(){it&&it.send("set-main-menu",(0,rt.c)({project:i,canSaveProjectAs:s,i18n:a,recentProjectFiles:u,shortcutMap:c,isApplicationTopLevelMenu:l}))}),[a,f,i,s,u,c,l]);var k=t.onOpenRecentFile;return(0,et.gT)("OPEN_RECENT_PROJECT",!0,{generateOptions:o.useCallback((function(){return u.map((function(e){return{text:e.fileMetadata.fileIdentifier,handler:function(){return k(e)}}}))}),[k,u])}),null},pt=t(50790),ft=t.n(pt),dt=t(91479),ht=t.n(dt),vt=g()("path"),mt=g()("os"),gt=g()("fs"),xt=function(e){var r=e.onWriteFile,t=vt.join(mt.tmpdir(),"GDGeneratedEventsFunctions-"+oe());gt.mkdir(t,(function(e){e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)}));var n=function(e){return"".concat(t,"/").concat(ht()(e),".js")};return{getIncludeFileFor:function(e){return n(e)},writeFunctionCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeBehaviorCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeObjectCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))}}},wt=t(85529),bt=t(182),yt=t(5712),Pt=t(41006),jt=g()("fs-extra"),kt=g()("path"),Zt=g()("@electron/remote"),St=Zt?Zt.dialog:null,Ft=(0,ee.Z)((function e(){(0,q.Z)(this,e)}));Ft.chooseEventsFunctionExtensionFile=function(e){if(!St)return Promise.reject("Not supported");var r=Zt.getCurrentWindow();return St.showSaveDialog(r,{title:"Export an extension of the project",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}],defaultPath:e||"Extension.json"}).then((function(e){var r=e.filePath;return r||null}))},Ft.writeEventsFunctionsExtension=function(e,r){return function(e,r){if(!jt)return Promise.reject(new Error("Filesystem is not supported."));try{var t=JSON.stringify(e,null,2);return jt.ensureDir(kt.dirname(r)).then((function(){return new Promise((function(e,n){jt.writeFile(r,t,(function(r){return r?n(r):e()}))}))}))}catch(n){return Promise.reject(n)}}((0,Pt.XH)(e),r).catch((function(e){throw console.error("Unable to write the events function extension:",e),e}))};var Et=g()("fs"),Dt=g()("@electron/remote"),Ct=Dt?Dt.dialog:null,Nt=(0,ee.Z)((function e(){(0,q.Z)(this,e)}));Nt.chooseEventsFunctionExtensionFile=function(){if(!Ct)return Promise.reject("Not supported");var e=Dt.getCurrentWindow();return Ct.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?r[0]:null}))},Nt.readEventsFunctionExtensionFile=function(e){return function(e){return Et?new Promise((function(r,t){Et.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")}(e)};var Ot,Rt,At=t(56924),Tt=function(e,r){var t=r.isReferenceMagicPropertyName,n=r.getReferencePartialObject,o=r.maxUnsplitDepth;return function e(r,a){if(void 0!==o&&a>=o)return Promise.resolve();if(null!==r&&"object"===typeof r){var i=Object.keys(r);if(i)return Promise.all(i.map((function(o){var i=function(e){return!0===e[t]?e:null}(r[o]);return i?n(i.referenceTo).then((function(t){return r[o]=t,e(r[o],a+1)})):e(r[o],a+1)}))).then((function(){}))}return Promise.resolve()}(e,0)},Lt=function(e){var r={};return function(t,n){var o=t[e];if("string"!==typeof o)throw new Error("Property ".concat(e," is not a string"));r[n]=r[n]||{};var a=(0,w.Z)(ht()(o),(function(e){return!!r[n][e]}));return r[n][a]=!0,a}},It=g()("fs"),Mt=g()("path"),Ut=g()("@electron/remote"),_t=Ut?Ut.dialog:null,Jt=function(e){return It?new Promise((function(r,t){It.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")},Wt=function(){if(!_t)return Promise.reject("Not supported");var e=Ut.getCurrentWindow();return _t.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your GDevelop 4 project, be sure to save it as a .json file",filters:[{name:"GDevelop 5 project",extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?{fileIdentifier:r[0]}:null}))},Bt=function(e){var r=e.fileIdentifier,t=Mt.dirname(r);return Jt(r).then((function(e){return Tt(e,{getReferencePartialObject:function(e){return Jt(Mt.join(t,e)+".json")},isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then((function(){return{content:e}}))}))},Gt=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,o=n+".autosave",!It.existsSync(o)){e.next=15;break}if(a=It.statSync(o).mtime.getTime(),t){e.next=6;break}return e.abrupt("return",a);case 6:return e.prev=6,i=It.statSync(n).mtime.getTime(),e.abrupt("return",a>i+5e3?a:null);case 11:return e.prev=11,e.t0=e.catch(6),console.error("Unable to compare *.autosave to project",e.t0),e.abrupt("return",null);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(r,t){return e.apply(this,arguments)}}(),Ht=function(e){return Promise.resolve((0,n.Z)((0,n.Z)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}))},zt=g()("fs-extra"),Kt=g()("path"),Xt=g()("@electron/remote"),Vt=Xt?Xt.dialog:null,Yt=["layouts","externalLayouts","externalEvents","eventsFunctionsExtensions"],Qt=function(e,r){var t=performance.now();return new Promise((function(n,o){zt.readFile(e,{encoding:"utf8"},(function(a,i){if(a)return o(a);""===i&&o(new Error("Written file is empty, did the write fail?")),i!==r&&o(new Error("Written file is not containing the expected content, did the write fail?"));var s=performance.now()-t;console.info("Verified ".concat(e," content in ").concat(s.toFixed(),"ms.")),n()}))}))},$t=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt){e.next=2;break}throw new Error("Filesystem is not supported.");case 2:if(""!==r){e.next=4;break}throw new Error("The content to save on disk is empty. Aborting.");case 4:return e.next=6,zt.ensureDir(Kt.dirname(t));case 6:return e.next=8,zt.writeFile(t,r);case 8:return e.next=10,Qt(t,r);case 10:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),qt=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(r,null,2),e.next=3,$t(n,t);case 3:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),en=function(e,r,t){var n,o=(0,Pt.XH)(e);if(e.isFolderProject()){var a=function(e,r){var t=r.pathSeparator,n=r.getArrayItemReferenceName,o=r.shouldSplit,a=r.isReferenceMagicPropertyName,i=[],s=function(e,r){var t;return i.push({reference:e,object:r}),t={},(0,_.Z)(t,a,!0),(0,_.Z)(t,"referenceTo",e),t};return function e(r,a,i){if(null!==r&&"object"===typeof r)if(Array.isArray(r))for(var u in r){var c=a+t+"*";if(o(c)){var l=r[u],p=n(l,i),f=i+t+p;r[u]=s(f,l),e(l,c,f)}else{var d=i+t+u;e(r[u],c,d)}}else for(var h in r){var v=a+t+h,m=i+t+h;if(o(v)){var g=r[h];r[h]=s(m,g),e(g,v,m)}else e(r[h],v,m)}}(e,"",""),i}(o,{pathSeparator:"/",getArrayItemReferenceName:Lt("name"),shouldSplit:(n=new Set(Yt.map((function(e){return"/".concat(e,"/*")}))),function(e){return n.has(e)}),isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT"});return Promise.all(a.map((function(e){return qt(e.object,Kt.join(t,e.reference)+".json").catch((function(e){throw console.error("Unable to write a partial file:",e),e}))}))).then((function(){return qt(o,r).catch((function(e){throw console.error("Unable to write the split project:",e),e}))}))}return qt(o,r).catch((function(e){throw console.error("Unable to write the project:",e),e}))},rn=function(e,r){var t=r.fileIdentifier,o=Date.now();if(!t)return Promise.reject('Project file is empty, "Save as" should have been called?');var a=(0,n.Z)((0,n.Z)({},r),{},{name:e.getName(),gameId:e.getProjectUuid(),lastModifiedDate:o}),i=Kt.dirname(t);return en(e,t,i).then((function(){return{wasSaved:!0,fileMetadata:a}}))},tn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.project,t=r.fileMetadata,n=t?t.fileIdentifier:"",o=Xt.getCurrentWindow(),a={defaultPath:n,filters:[{name:"GDevelop 5 project",extensions:["json"]}]},Vt){e.next=6;break}throw new Error("Unsupported");case 6:if(i=Vt.showSaveDialogSync(o,a)){e.next=9;break}return e.abrupt("return",{saveAsLocation:null});case 9:return e.abrupt("return",{saveAsLocation:{fileIdentifier:i}});case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),nn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t,n){var o,a,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("A location was not chosen before saving as.");case 2:if(o=t.fileIdentifier){e.next=5;break}throw new Error("A file path was not chosen before saving as.");case 5:return n.onStartSaving(),a={fileIdentifier:o,name:r.getName(),gameId:r.getProjectUuid(),lastModifiedDate:Date.now()},e.next=9,n.onMoveResources({newFileMetadata:a});case 9:return i=Kt.dirname(o),r.setProjectFile(o),e.next=13,en(r,o,i);case 13:return e.abrupt("return",{wasSaved:!0,fileMetadata:a});case 14:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),on=function(e,r){var t=r.fileIdentifier+".autosave";return $t((0,Pt.h_)(e),t).catch((function(e){throw console.error("Unable to write ".concat(t,":"),e),e}))},an=function(e){return{id:"An error occurred when saving the project. Please try again by choosing another location."}},sn=/\\ | \/ | : | \* | \? | " | < | > | \|/g,un=/\s+/g,cn=function(e){var r=e.projectName,t=e.saveAsLocation,n=e.newProjectsDefaultFolder,o=t?Kt.dirname(t.fileIdentifier):n||"",a=r?function(e){return(e.length>200?e.substring(0,200):e).replace(sn," ").replace(un," ").trim()}(r)+".json":"game.json";return{fileIdentifier:Kt.join(o,a)}},ln=function(e){if(!Xt)return!1;var r=Xt.app.getPath("exe");if(!r)return!1;var t=Kt.dirname(r);return e.startsWith(t)},pn=t(78118),fn=o.memo((function(e){return(0,R.jsx)(pn.Z,(0,n.Z)((0,n.Z)({},e),{},{viewBox:"0 0 16 16",style:{fill:"none"},children:(0,R.jsx)("path",{d:"M5.75 11.25C5.75 11.25 6 14.25 4 15.25H12C10 14.25 10.25 11.25 10.25 11.25M5.75 11.25H13.25C14.3546 11.25 15.25 10.3546 15.25 9.25V2.75C15.25 1.64543 14.3546 0.75 13.25 0.75H2.75C1.64543 0.75 0.75 1.64543 0.75 2.75V9.25C0.75 10.3546 1.64543 11.25 2.75 11.25H5.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}))})),dn=t(18455),hn=t.g.gd,vn=cr("glob"),mn=g()("path"),gn=g()("@electron/remote"),xn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s,c,l,f,d;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.extensions,o=r.createResource,a=vn()){e.next=4;break}return e.abrupt("return");case 4:return i=t.getResourcesManager(),s=mn.dirname(t.getProjectFile()),c=[].concat((0,p.Z)(n),(0,p.Z)(n.map((function(e){return e.toUpperCase()})))),e.prev=7,e.next=10,new Promise((function(e,r){a(s+"/**/*.{"+c.join(",")+"}",(function(t,n){t?r(t):e(n)}))}));case 10:l=e.sent,f=new hn.VectorString,l.forEach((function(e){return f.push_back(mn.relative(s,e))})),d=t.getResourcesManager().findFilesNotInResources(f),f.delete(),(0,dn.mapVector)(d,(function(e){var r=(0,w.Z)(e,(function(e){return i.hasResource(e)})),n=o();n.setFile(e),n.setName(r),(0,v.r3)(t,n),i.addResource(n),n.delete(),console.info('"'.concat(e,'" added to project as resource named "').concat(r,'".'))})),e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(7),console.error("Error finding files inside ".concat(s,":"),e.t0),e.abrupt("return");case 22:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(r){return e.apply(this,arguments)}}(),wn=t(71046),bn=t.n(wn),yn=t(85166),Pn=t.n(yn),jn=t(43734),kn=t.n(jn),Zn=g()("path"),Sn=g()("electron"),Fn=Sn?Sn.ipcRenderer:null,En=Fn&&Zn?function(e){var r=e.fileIdentifier,t=e.callback,n=e.options,o=Pn()(kn()((function(){return bn()((function(e){var r=Zn.relative(a,e).replace(/\\/g,"/");t({identifier:r})}),200,{leading:!1,trailing:!0})})),(function(e,r){return e(r)(r)})),a=Zn.dirname(r),i=Zn.basename(r),s=i+".autosave";Fn.on("project-file-changed",(function(e,r){o(r)}));var u=["**/.DS_Store","**/.git/**",Zn.join(a,i),Zn.join(a,s)];n&&n.isProjectSplitInMultipleFiles&&u.push.apply(u,(0,p.Z)(Yt.map((function(e){return Zn.join(a,e,"*.json")}))));var c=Fn.invoke("local-filesystem-watcher-setup",a,JSON.stringify({ignore:u}));return function(){Fn.removeAllListeners("project-file-changed"),c.then((function(e){Fn.invoke("local-filesystem-watcher-disable",e)}))}}:void 0,Dn={internalName:"LocalFile",name:{id:"Your computer"},renderIcon:function(e){return(0,R.jsx)(fn,{fontSize:e.size})},getFileMetadataFromAppArguments:function(e){return e[i.rM]&&e[i.rM].length?{fileIdentifier:e[i.rM][0]}:null},getProjectLocation:cn,renderNewProjectSaveAsLocationChooser:function(e){var r=e.projectName,t=e.saveAsLocation,n=e.setSaveAsLocation,o=e.newProjectsDefaultFolder,a=cn({projectName:r,saveAsLocation:t,newProjectsDefaultFolder:o});return(0,R.jsx)(Le.Z,{fullWidth:!0,value:Kt.dirname(a.fileIdentifier),onChange:function(e){var t=Kt.join(e,Kt.basename(a.fileIdentifier));n(cn({projectName:r,saveAsLocation:{fileIdentifier:t},newProjectsDefaultFolder:o}))},type:"create-game"})},setupResourcesWatcher:En,createOperations:function(){return{onOpenWithPicker:Wt,onOpen:Bt,getAutoSaveCreationDate:Gt,onSaveProject:rn,onChooseSaveProjectAsLocation:tn,onSaveProjectAs:nn,onAutoSaveProject:on,onGetAutoSave:Ht,getOpenErrorMessage:function(e){return{id:"Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorization to open it."}},getWriteErrorMessage:an,canFileMetadataBeSafelySaved:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,!ln(n)){e.next=4;break}return e.next=4,t.showAlert({title:{id:"Choose another location"},message:{id:"Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project."}});case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),canFileMetadataBeSafelySavedAs:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,!ln(n)){e.next=5;break}return e.next=4,t.showAlert({title:{id:"Choose another location"},message:{id:"Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project."}});case 4:return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()}},createResourceOperations:function(){return function(e){var r=e.project,t=e.resource,n=e.i18n,o=e.updateInterface,a=e.cleanUserSelectionOfResources,i=e.informUser;return[{label:n._({id:"Locate file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.shell.showItemInFolder(mn.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Open file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.shell.openPath(mn.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Copy file path"}),click:function(){!function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.clipboard.writeText(mn.resolve(n))}({project:r,resource:t}),i({message:(0,R.jsx)(f.Trans,{id:"Resource file path copied to clipboard"})})}},{type:"separator"},{label:n._({id:"Scan in the project folder for..."}),submenu:d.Q.map((function(e){var t=e.displayName,a=e.fileExtensions,i=e.createNewResource;return{label:n._(t),click:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xn({project:r,extensions:a,createResource:i});case 2:o();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))},{label:n._({id:"Remove resources with invalid path"}),click:function(){!function(e){var r=e.project,t=r.getResourcesManager();t.getAllResourceNames().toJSArray().filter((function(e){return"error"===(0,v.iz)(r,e)})).forEach((function(e){t.removeResource(e),console.info("Removed due to invalid path: "+e)}))}({project:r}),a(),o()}}]}}},Cn=g()("electron"),Nn=Cn?Cn.ipcRenderer:null,On=function(){var e=o.useContext(tt.ZP).values.useGDJSDevelopmentWatcher;return o.useEffect((function(){if(e){if(Nn)return Nn.send("setup-local-gdjs-development-watcher"),function(){Nn.send("close-local-gdjs-development-watcher")};console.error("Unable to find ipcRenderer to set up GDJS development watchers")}}),[e]),null},Rn=t(32438),An=t(8018),Tn=t(38428),Ln=t.n(Tn),In=t(997),Mn=t(36465),Un=t(84140),_n=t(72702),Jn=t(34517),Wn=t(14446),Bn=t.n(Wn),Gn=g()("electron"),Hn=Gn?Gn.ipcRenderer:null,zn=g()("fs-extra"),Kn=g()("path"),Xn=function(e,r,t){var n=Kn.extname(t),o=Kn.basename(t,n),a=(0,w.Z)(o,(function(t){var o=Kn.join(e,t)+n;return zn.existsSync(o)||r.has(o)}));return Kn.join(e,a)+n},Vn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Hn){e.next=2;break}throw new Error("Not supported");case 2:return e.next=4,Bn().get(r,{responseType:"arraybuffer"});case 4:return n=e.sent,o=n.data,e.next=8,Hn.invoke("local-file-save-from-arraybuffer",o,t);case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),Yn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s,c,p,f,d,h,m,g;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.fileMetadata,o=r.onProgress,a=r.authenticatedUser,zn&&Hn){e.next=3;break}throw new Error("Unsupported");case 3:return i=t.getResourcesManager(),s=i.getAllResourceNames().toJSArray(),c=s.filter((function(e){var r=i.getResource(e).getFile();return(0,v.PX)(r)})),e.next=8,(0,Mn._w)({authenticatedUser:a,allResourcePaths:c.map((function(e){return i.getResource(e).getFile()}))});case 8:return p=e.sent,f=Kn.dirname(n.fileIdentifier),d=Kn.join(f,"assets"),h=new Set,m=[],g=0,e.next=16,Ln().withConcurrency(50).for(c).process(function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,a,s,x,w,b,y;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.getResource(r),n=t.getFile(),!(0,v.PX)(n)){e.next=30;break}if(!(0,v.Gu)(n)){e.next=19;break}return e.prev=4,a=(0,v.OI)(t),s=a.localFilePath,x=a.extension,w=s?Kn.resolve(f,s):Xn(d,h,(0,_n.B)(t.getName()+(x||""))),e.next=9,zn.ensureDir(d);case 9:return e.next=11,Vn(n,w);case 11:t.setFile(Kn.relative(f,w).replace(/\\/g,"/")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),m.push({resourceName:r,error:e.t0});case 17:e.next=30;break;case 19:return b=(0,Mn.bW)(n)?(0,Mn.jV)(n):(0,Un.d0)(n)?(0,Un.Lj)(n):(0,Jn.dh)(n),y=Xn(d,h,b),h.add(y),e.prev=22,e.next=25,(0,In.x)({times:2},(0,l.Z)((0,u.Z)().mark((function e(){var r,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn.ensureDir(d);case 2:return r=new URL(n),(0,Mn.uG)(r.href)&&p&&r.searchParams.set("token",p),o=r.href,e.next=7,Hn.invoke("local-file-download",o,y);case 7:t.setFile(Kn.relative(f,y).replace(/\\/g,"/"));case 8:case"end":return e.stop()}}),e)}))));case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(22),m.push({resourceName:r,error:e.t1});case 30:o(g++,c.length);case 31:case"end":return e.stop()}}),e,null,[[4,14],[22,27]])})));return function(r){return e.apply(this,arguments)}}());case 16:return e.abrupt("return",{erroredResources:m});case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Qn=t(10822),$n=t(85919),qn=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r,t){var n,o,a,i,s,c;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transformItem,o=t.isChunkTooBig,a=t.processChunk,i=0,s=[];case 3:if(!(i<r.length)){e.next=20;break}return e.next=6,n(r[i]);case 6:if(c=e.sent,s.length){e.next=10;break}e.next=16;break;case 10:if(o([].concat(s,[c]))){e.next=13;break}e.next=16;break;case 13:return e.next=15,a(s);case 15:s.length=0;case 16:s.push(c),i++,e.next=3;break;case 20:if(!s.length){e.next=24;break}return e.next=23,a(s);case 23:s.length=0;case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),eo=g()("path"),ro=g()("fs"),to=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){ro.readFile(r,(function(r,n){r?t(r):e(n)}))}));case 2:return t=e.sent,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),no={aac:"audio/aac",wav:"audio/wav",mp3:"audio/mp3",ogg:"audio/ogg",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",webp:"image/webp",ttf:"font/ttf",otf:"font/otf",mp4:"video/mp4",webm:"video/webm",json:"application/json",xml:"application/xml",gz:"application/gzip",js:"application/javascript"},oo=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,to(r);case 2:return t=e.sent,n=eo.extname(r).replace(/^\./,""),e.abrupt("return",new File([t],eo.basename(r),{type:no[n]||"application/octet-stream"}));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ao=g()("path"),io=t.g.gd,so=function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a,i,s,c,p,f,d,h;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.authenticatedUser,o=r.oldFileMetadata,a=r.newFileMetadata,i=r.onProgress,s={erroredResources:[]},c=a.fileIdentifier,p=t.getResourcesManager(),f=function(e){return p.getAllResourceNames().toJSArray().map((function(e){var r=p.getResource(e),t=r.getFile();return(0,v.PX)(t)?(0,$n.yk)(t)?null:(0,v.Gu)(t)?(s.erroredResources.push({resourceName:r.getName(),error:new Error("Unsupported blob URL.")}),null):null:r})).filter(Boolean)}(),d=ao.dirname(o.fileIdentifier),h=0,e.next=10,qn(f,{transformItem:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ao.resolve(d,r.getFile()),e.prev=1,e.next=4,oo(t);case 4:return n=e.sent,e.abrupt("return",{resource:r,file:n});case 8:return e.prev=8,e.t0=e.catch(1),s.erroredResources.push({resourceName:r.getName(),error:new Error("Unable to open the file (".concat(t,")."))}),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),isChunkTooBig:function(e){return e.length>70||e.filter(Boolean).reduce((function(e,r){return e+r.file.size}),0)>15e7},processChunk:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.filter(Boolean),e.next=3,(0,Jn.LG)(n,c);case 3:return e.next=5,(0,Jn.ll)(n,c,t.map((function(e){return e.file})),(function(e,r){i(h+e,f.length)}));case 5:o=e.sent,h+=r.length,o.forEach((function(e,r){var n=e.url,o=e.error,a=t[r].resource;!o&&n?a.setFile(n):s.erroredResources.push({resourceName:a.getName(),error:o||new Error("Unknown error during upload.")})}));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()});case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),uo=(Ot={},(0,_.Z)(Ot,"".concat(Dn.internalName,"=>").concat(Dn.internalName),function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.newFileMetadata,o=ao.dirname(n.fileIdentifier),a=Pe()(new io.AbstractFileSystemJS,new pe),io.ProjectResourcesCopier.copyAllResourcesTo(t,a,o,!0,!1,!0),e.abrupt("return",{erroredResources:[]});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),(0,_.Z)(Ot,"".concat(Rn.Z.internalName,"=>").concat(Dn.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return Yn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,_.Z)(Ot,"".concat(An.Z.internalName,"=>").concat(Dn.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return Yn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,_.Z)(Ot,"".concat(Dn.internalName,"=>").concat(Rn.Z.internalName),so),(0,_.Z)(Ot,"".concat(Rn.Z.internalName,"=>").concat(Rn.Z.internalName),Qn.G),(0,_.Z)(Ot,"".concat(An.Z.internalName,"=>").concat(Rn.Z.internalName),Qn.G),Ot),co={moveAllProjectResources:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.oldStorageProvider,n=r.newStorageProvider,o=uo["".concat(t.internalName,"=>").concat(n.internalName)]){e.next=4;break}throw new Error("Can't find a ResourceMover for ".concat(t.internalName," to ").concat(n.internalName,"."));case 4:return e.abrupt("return",o(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},lo=co,po=t(58271),fo=t(527),ho=(Rt={},(0,_.Z)(Rt,Rn.Z.internalName,fo.f),(0,_.Z)(Rt,Dn.internalName,Yn),(0,_.Z)(Rt,An.Z.internalName,po.j),Rt),vo={fetchAllProjectResources:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.storageProvider,n=ho[t.internalName]){e.next=4;break}throw new Error("Can't find a ResourceFetcher for ".concat(t.internalName," - have you registered the storage provider here?"));case 4:return e.abrupt("return",n(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},mo=vo,go=t(71445),xo=t(1333),wo=t(23236),bo=i.ZP.isDev(),yo=function(){function e(r){(0,q.Z)(this,e),this.auth=r}return(0,ee.Z)(e,[{key:"loginWithEmailAndPassword",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.email,n=r.password,e.prev=1,e.next=4,(0,go.e5)(this.auth,t,n);case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(1),console.error("Error while login:",e.t0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(r){return e.apply(this,arguments)}}()},{key:"loginOrSignupWithProvider",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(r){var t,n,o,a=this;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.provider,!(n=r.signal)||!n.aborted){e.next=3;break}return e.abrupt("return",Promise.reject(new wo.s("Login or Signup with provider already aborted.")));case 3:return o=new Promise((function(e,r){n&&n.addEventListener("abort",(function(){(0,xo.g)(),r(new wo.s("Login or Signup with provider already aborted."))})),(0,xo.T)({onConnectionEstablished:function(e){if(!n||!n.aborted){var r=new URL("https://auth.gdevelop.io");r.searchParams.set("connection-id",e),r.searchParams.set("provider",t),r.searchParams.set("env",bo?"dev":"live"),i.ZP.openExternalURL(r.toString())}},onTokenReceived:function(){var t=(0,l.Z)((0,u.Z)().mark((function t(o){var i,s,c;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.provider,s=o.data,!n||!n.aborted){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,c="google"===i?go.hJ.credential(s.credential):"github"===i?go.GH.credential(s.accessToken):new go.O4("apple.com").credential({idToken:s.id_token,nonce:s.raw_nonce}),t.next=7,(0,go.sB)(a.auth,c);case 7:e(),(0,xo.g)(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("An error occurred while logging in with ".concat(i," token:"),t.t0),r(t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}(),onError:function(e){n&&n.aborted||((0,xo.g)(),console.error("An error occurred while setting up authentication web socket:",e),r(new Error("An error occurred while setting up authentication web socket.")))},onTimeout:function(){n&&n.aborted||((0,xo.g)(),console.error("Connection to authorization websocket timed out."),r(new Error("Connection to authorization websocket timed out.")))}})})),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}]),e}(),Po=yo,jo=t.g.gd,ko=function(e){i.ZP.setUpContextMenu();var r=new Po(e.auth);e.setLoginProvider(r);var t=i.ZP.getArguments(),o=i.ZP.isDev();return(0,R.jsx)(yt.Z,{authentication:e,disableCheckForUpdates:!!t["disable-update-check"],makeEventsFunctionCodeWriter:xt,eventsFunctionsExtensionWriter:Ft,eventsFunctionsExtensionOpener:Nt,children:function(e){var r=e.i18n;return(0,R.jsx)(At.Z,{appArguments:t,storageProviders:[Dn,An.Z,Rn.Z],defaultStorageProvider:Dn,children:function(e){var t=e.getStorageProviderOperations,i=e.getStorageProviderResourceOperations,u=e.storageProviders,c=e.initialFileMetadataToOpen,l=e.getStorageProvider;return(0,R.jsx)(a.Z,{i18n:r,renderMainMenu:function(e,r,t){return(0,R.jsx)(lt,{props:e,callbacks:r,extraCallbacks:t})},renderPreviewLauncher:function(e,r){return(0,R.jsx)(Te,(0,n.Z)((0,n.Z)({},e),{},{ref:r}))},renderShareDialog:function(e){return(0,R.jsx)(s.Z,{project:e.project,onSaveProject:e.onSaveProject,isSavingProject:e.isSavingProject,onChangeSubscription:e.onChangeSubscription,onClose:e.onClose,automatedExporters:$r,manualExporters:qr,onlineWebExporter:Qr,fileMetadata:e.fileMetadata,storageProvider:e.storageProvider,initialTab:e.initialTab})},renderGDJSDevelopmentWatcher:o?function(){return(0,R.jsx)(On,{})}:null,storageProviders:u,resourceMover:lo,resourceFetcher:mo,getStorageProviderOperations:t,getStorageProviderResourceOperations:i,getStorageProvider:l,resourceSources:U,resourceExternalEditors:$,extensionsLoader:ft()({gd:jo,objectsEditorService:wt.Z,objectsRenderingService:bt.Z,filterExamples:!o}),initialFileMetadataToOpen:c})}})}})}}}]);
//# sourceMappingURL=local-app.6a99b38d.chunk.js.map